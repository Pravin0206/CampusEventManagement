<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title> My Event Registrations </title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<style>
body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    background: url("@{/images/campuseventimages.jpg}") no-repeat center center fixed;
    background-size: cover;
    display: flex;
    justify-content: center;
    padding-top: 50px;
}

.sidebar {
	width: 220px;
	background: linear-gradient(to right top, #051937, #004d7a, #008793, #00bf72, #a8eb12);
    /* Added backdrop blur for a "glass" effect */
    backdrop-filter: blur(5px);
	color: white;
	display: flex;
	flex-direction: column;
	padding: 20px;
}

.sidebar h2 {
	margin-bottom: 30px;
	text-align: center;
}

.sidebar a {
	color: white;
	text-decoration: none;
	padding: 10px 0;
	margin: 5px 0;
	border-radius: 5px;
	transition: all 0.3s ease;
}

.sidebar a:hover {
	background-color: rgba(255, 255, 255, 0.2);
}

.main-content {
	flex: 1;
	background-image: linear-gradient(to right top, #717d99, #159fc8, #00c2c7, #00dd8b, #a8eb12);
	margin: 20px;
	border-radius: 15px;
	padding: 40px;
	box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
	overflow-y: auto;
}

h1 {
	font-size: 2em;
	margin-bottom: 20px;
	color: #333;
}

table {
	width: 100%;
	border-collapse: collapse;
}

th, td {
	padding: 12px;
	border: 1px solid #ccc;
	text-align: center;
}

th {
	background-color: #673AB7;
	color: white;
}

img.event-thumb {
	width: 80px;
	height: 60px;
	object-fit: cover;
	border-radius: 6px;
}

a.btn {
	text-decoration: none;
	padding: 6px 12px;
	border-radius: 6px;
	color: white;
	background: #f44336;
	cursor: pointer;
}

a.btn:hover {
	opacity: 0.85;
}
</style>
</head>
<body>
<body>
<div class="sidebar">
    <h2>Student Menu</h2>
    <a th:href="@{/student/dashboard}">Dashboard</a>
    <a th:href="@{/student/events}">View Events</a>
    <a th:href="@{/student/registrations}">My Registrations</a>
    <a th:href="@{/student/reports}">ðŸ“Š Reports</a>
    <a th:href="@{/users/profile}">ðŸ‘¤ Profile</a>
    <a th:href="@{/logout}">Logout</a>
</div>

<div class="main-content">
    <h1>My Registered Events</h1>

    <div th:if="${message}"
         style="margin-bottom: 15px; padding: 10px; background-color: #dff0d8; color: #3c763d; border-radius: 6px;">
        <span th:text="${message}"></span>
    </div>

    <div th:if="${attendanceMessage}"
         style="margin-bottom: 15px; padding: 10px; background-color: #dff0d8; color: #3c763d; border-radius: 6px;">
        <span th:text="${attendanceMessage}"></span>
    </div>

    <table>
        <thead>
            <tr>
                <th>Image</th>
                <th>Title</th>
                <th>Date</th>
                <th>Time</th>
                <th>Location</th>
                <th>Category</th>
                <th>Status & Action</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="reg : ${registrations}">
                <td>
                    <img th:if="${reg.event.imageUrl}" th:src="${reg.event.imageUrl}" class="event-thumb" alt="Event">
                    <span th:if="${reg.event.imageUrl == null}">No Image</span>
                </td>
                <td th:text="${reg.event.title}">Event Title</td>
                <td th:text="${reg.event.date}">2025-09-30</td>
                <td th:text="${reg.event.time}">09:00</td>
                <td th:text="${reg.event.location}">Bangalore</td>
                <td th:text="${reg.event.category.name}">Sports</td>

					<td>
						<!-- Cancel Registration Button -->
						<form
							th:action="@{/student/registrations/delete/{id}(id=${reg.id})}"
							method="post" style="display: inline;">
							<button type="submit" class="btn btn-outline-danger btn-sm"
								onclick="return confirm('Cancel this registration?');">
								Cancel</button>
						</form> <!-- Attendance Status / Action --> <span
						th:if="${reg.attendance != null}"> <span
							th:if="${reg.attendance.status.name() == 'APPROVED'}"
							class="badge bg-success ms-2"> Attendance Approved </span> <span
							th:if="${reg.attendance.status.name() == 'PENDING'}"
							class="badge bg-warning text-dark ms-2"> Pending Admin
								Approval </span> <span
							th:if="${reg.attendance.status.name() == 'REJECTED'}"
							class="badge bg-danger ms-2"> Attendance Rejected </span>
					</span> <!-- Mark Attendance Button if not marked --> <span
						th:if="${reg.attendance == null}">
							<form
								th:action="@{/student/attendance/mark/{registrationId}(registrationId=${reg.id})}"
								method="post" style="display: inline;">
								<button type="submit"
									class="btn btn-outline-primary btn-sm ms-2">Mark
									Attendance</button>
							</form>
					</span>
					</td>


				</tr>
            <tr th:if="${#lists.isEmpty(registrations)}">
                <td colspan="7">You have not registered for any events yet.</td>
            </tr>
        </tbody>
    </table>
</div>

</body>
</html>