<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title> Manage Events </title>
<style>
body {
	margin: 0;
	font-family: Arial, sans-serif;
	background: url('/images/admindashboard.jpg') no-repeat center center
		fixed;
	background-size: cover;
	display: flex;
}

/* Sidebar */
.sidebar {
	width: 220px;
	background: linear-gradient(to right top, #053715, #2f5918, #627b14, #a19b09,
		#ebb612);
	backdrop-filter: blur(10px);
	color: white;
	padding: 20px;
	display: flex;
	flex-direction: column;
}

.sidebar h2 {
	margin-bottom: 20px;
}

.sidebar a {
	color: white;
	text-decoration: none;
	margin: 10px 0;
	display: block;
}

.sidebar a:hover {
	text-decoration: underline;
}

/* Main container */
.container {
	background: rgba(255, 255, 255, 0.95);
	padding: 30px;
	margin: 50px;
	border-radius: 12px;
	box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
	width: 90%;
}

h2 {
	text-align: center;
	margin-bottom: 20px;
}

table {
	width: 100%;
	border-collapse: collapse;
}

th, td {
	padding: 12px;
	border: 1px solid #ccc;
	text-align: center;
	vertical-align: middle;
}

th {
	background-color: #673AB7;
	color: white;
}

img.event-thumb {
	width: 80px;
	height: 60px;
	object-fit: cover;
	border-radius: 6px;
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
}

a.btn, button.btn {
	text-decoration: none;
	padding: 6px 12px;
	border-radius: 6px;
	color: white;
	border: none;
	cursor: pointer;
}

a.btn:hover, button.btn:hover {
	opacity: 0.85;
}

.add-btn {
	background: #4CAF50;
	margin-bottom: 15px;
	display: inline-block;
}

.edit-btn {
	background: #FFC107;
}

.delete-btn {
	background: #f44336;
}

/* Filters */
#searchContainer {
	text-align: center;
	margin-bottom: 20px;
}

#searchContainer input, #searchContainer select {
	padding: 10px;
	font-size: 16px;
	border-radius: 5px;
	margin-right: 10px;
}

#searchContainer input[type="text"], #searchContainer input[type="date"]
	{
	width: 200px;
}
</style>
</head>
<body>
<!-- Sidebar -->
<div class="sidebar">
    <h2>‚öôÔ∏è Admin</h2>
    <a th:href="@{/admin/dashboard}">üè† Dashboard</a>
    <a th:href="@{/admin/events}">üìÖ Manage Events</a>
    <a th:href="@{/admin/categories}">üìÇ Manage Categories</a>
    <a th:href="@{/logout}">üö™ Logout</a>
</div>

<!-- Main Content -->
<div class="container">
    <h2>üìÖ Manage Events</h2>

    <!-- Filters -->
    <div id="searchContainer">
        <input type="text" id="searchInput" placeholder="Search by title...">
        <select id="categoryFilter">
            <option value="">All Categories</option>
            <option th:each="cat : ${categories}" th:value="${cat.id}" th:text="${cat.name}"></option>
        </select>
        <input type="date" id="dateFilter">
        <input type="text" id="locationFilter" placeholder="Location">
        <a th:href="@{/events/new}" class="btn add-btn">‚ûï Create Event</a>
    </div>

    <!-- Events Table -->
    <table id="eventsTable">
        <thead>
            <tr>
                <th>Image</th>
                <th>Title</th>
                <th>Date</th>
                <th>Time</th>
                <th>Location</th>
                <th>Category</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="event : ${events}" th:attr="data-category-id=${event.category.id}">
                <td>
                    <img th:if="${event.imageUrl}" th:src="@{${event.imageUrl}}" alt="Event Image" class="event-thumb"/>
                    <span th:if="${event.imageUrl == null}">No Image</span>
                </td>
                <td th:text="${event.title}">Event Title</td>
                <td th:text="${event.date}">2025-09-30</td>
                <td th:text="${event.time}">09:00</td>
                <td th:text="${event.location}">Bangalore</td>
                <td th:text="${event.category.name}">Sports</td>
                <td>
                    <a th:href="@{/events/update/{id}(id=${event.id})}" class="btn edit-btn">‚úè Edit</a>
                    <form th:action="@{/events/delete/{id}(id=${event.id})}" method="post" style="display:inline;" 
                          onsubmit="return confirm('Are you sure you want to delete this event?');">
                        <button type="submit" class="btn delete-btn">üóë Delete</button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<script>
const searchInput = document.getElementById('searchInput');
const categoryFilter = document.getElementById('categoryFilter');
const dateFilter = document.getElementById('dateFilter');
const locationFilter = document.getElementById('locationFilter');
const table = document.getElementById('eventsTable');
const tbodyRows = table.tBodies[0].rows;

function filterTable() {
    const searchText = searchInput.value.toLowerCase();
    const selectedCategoryId = categoryFilter.value;
    const selectedDate = dateFilter.value;
    const locationText = locationFilter.value.toLowerCase();

    for (let i = 0; i < tbodyRows.length; i++) {
        const cells = tbodyRows[i].cells;
        const rowTitle = cells[1].innerText.toLowerCase();
        const rowDate = cells[2].innerText;
        const rowLocation = cells[4].innerText.toLowerCase();
        const rowCategoryId = tbodyRows[i].getAttribute("data-category-id");

        const matchesSearch = rowTitle.includes(searchText);
        const matchesCategory = selectedCategoryId === "" || rowCategoryId === selectedCategoryId;
        const matchesDate = selectedDate === "" || rowDate === selectedDate;
        const matchesLocation = rowLocation.includes(locationText);

        tbodyRows[i].style.display = (matchesSearch && matchesCategory && matchesDate && matchesLocation) ? '' : 'none';
    }
}

searchInput.addEventListener('keyup', filterTable);
categoryFilter.addEventListener('change', filterTable);
dateFilter.addEventListener('change', filterTable);
locationFilter.addEventListener('keyup', filterTable);
</script>
</body>
</html>